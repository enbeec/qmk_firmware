#include "keymap.h"

// idobo 5x15 ortholinear keyboard
// Val's Keymap Version 01

enum {
	QWERTY = 0,
    _RAISE,
    _LOWER,
	FN_LAY,
	_BONUS,
	ADJUST
};

// ┌───┬───┬───┬───┬───┬───┬───┬───┬───┬───┐
// │ ! │ @ │ # │ $ │ % │ ^ │ & │ * │ ( │ ) │
// │ Q │ W │ E │ R │ T │ Y │ U │ I │ O │ P │
// │ 1 │ 2 │ 3 │ 4 │ 5 │ 6 │ 7 │ 8 │ 9 │ 0 │
// └───┴───┴───┴───┴───┴───┴───┴───┴───┴───┘
// ┌───┬───┬───┬───┬───┬───┬───┬───┬───┬───┐
// │   │   │   │   │   │ | │ _ │ + │ { │ } │
// │ A │ S │ D │ F │ G │ H │ J │ K │ L │ ; │
// │   │   │   │   │   │ \ │ - │ = │ [ │ ] │
// └───┴───┴───┴───┴───┴───┴───┴───┴───┴───┘
// ┌───┬───┬───┬───┬───┬───┬───┬───┬───┬───┐
// │   │   │   │   │   │   │ ~ │   │   │   │
// │ Z │ X │ C │ V │ B │ N │ M │ , │ . │ / │
// │   │   │   │   │   │   │ ` │   │   │   │
// └───┴───┴───┴───┴───┴───┴───┴───┴───┴───┘

const uint16_t PROGMEM keymaps[][MATRIX_ROWS][MATRIX_COLS] = {
	[QWERTY] = LAYOUT_ortho_5x15(
            KC_GRAVE,   NUM__ROW___L,   NUM__ROW___R,   _______,_______,_______,_______,
            KC_TAB,     Q___THRU___T,   Y___THRU___P,   _______,_______,_______,_______,
            KC_ESC,     A___THRU___F,   H_THRU_COLON,   KC_ENT ,_______,_______,_______,
            KC_LSFT,    Z___THRU___B,   N_THRU_SLASH,   KC_RSFT,_______,_______,_______,
            FN_TAP,     TRI_L,  PLANCK_SPACE,  TRI_R,   _______,_______,_______,_______
			),
	[_LOWER] = LAYOUT_ortho_5x15(
			_______,____________FUNC_KEY__L________________,____________FUNC_KEY__R________________,____________4_TRANS____________,
            _______,____________LOWER__R1_L________________,____________LOWER__R1_R________________,____________4_TRANS____________,
            _______,____________LOWER__R2_L________________,____________LOWER__R2_R________________,____________4_TRANS____________,
            _______,____________LOWER__R3_L________________,____________LOWER__R3_R________________,____________4_TRANS____________,
			_______,_______________5_TRANS_________________,_______________5_TRANS_________________,____________4_TRANS____________
			),
	[_RAISE] = LAYOUT_ortho_5x15(
			_______,____________FUNC_KEY__L________________,____________FUNC_KEY__R________________,____________4_TRANS____________,
            _______,____________RAISE__R1_L________________,____________RAISE__R1_R________________,____________4_TRANS____________,
            _______,____________RAISE__R2_L________________,____________RAISE__R2_R________________,____________4_TRANS____________,
            _______,____________RAISE__R3_L________________,____________RAISE__R3_R________________,____________4_TRANS____________,
			_______,_______________5_TRANS_________________,_______________5_TRANS_________________,____________4_TRANS____________
			),
	[FN_LAY] = LAYOUT_ortho_5x15(
			_______,____________FUNC_KEY__L________________,____________FUNC_KEY__R________________,____________4_TRANS____________,
			_______,_______,_______, KC_UP, _______,_______,_______,_______,_______,_______,_______,____________4_TRANS____________,
			KC_CAPS,_______,KC_LEFT,KC_DOWN,KC_RGHT,_______,KC_LEFT,KC_DOWN, KC_UP ,KC_RGHT,_______,____________4_TRANS____________,
			_______,_______,_______,_______,_______,_______,_______,_______,_______,_______,_______,____________4_TRANS____________,
			_______,_______,_______,_______,_______,_______,_______,_______,_______,_______,_______,____________4_TRANS____________
			),

	[_BONUS] = LAYOUT_ortho_5x15(
            _______,_______________5_TRANS_________________,_______________5_TRANS_________________,____________4_TRANS____________,
            _______,_______________5_TRANS_________________,_______________5_TRANS_________________,____________4_TRANS____________,
            _______,_______________5_TRANS_________________,_______________5_TRANS_________________,____________4_TRANS____________,
            _______,_______________5_TRANS_________________,_______________5_TRANS_________________,____________4_TRANS____________,
            _______,_______________5_TRANS_________________,_______________5_TRANS_________________,____________4_TRANS____________
			),

	[ADJUST] = LAYOUT_ortho_5x15(
			_______,_______,_______,_______,_______,_______,_______,_______,_______,_______,_______,_______,_______,_______,_______,
			_______,_______,_______,_______, RESET ,_______,_______,_______,_______,_______,_______,_______,_______,_______,_______,
			_______,_______,_______, DEBUG ,_______,_______,_______,_______,_______,_______,_______,_______,_______,RGB_TOG,_______,
            _______,_______________5_TRANS_________________,_______________5_TRANS_________________,____________4_TRANS____________,
            _______,_______,AG_NORM,AG_SWAP,_______,_______,_______,_______,AG_SWAP,AG_NORM,_______,____________4_TRANS____________
			)

};

uint8_t prev = QWERTY;
uint32_t check;
uint32_t desired = 9;

void matrix_init_user() {
	rgblight_sethsv(HSV_PURPLE);
}

uint32_t layer_state_set_user(uint32_t state) {
	uint8_t layer = biton32(state);
	/* no color change for adjustments layer */
	if (prev != ADJUST) {
		switch (layer) {
			case QWERTY:
				rgblight_sethsv(HSV_PURPLE);
				break;
			case FN_LAY:
				rgblight_sethsv(HSV_WHITE);
				break;
			case _BONUS:
				rgblight_sethsv(HSV_ORANGE);
				break;
			case ADJUST:
				break;
		}
	} else {
		desired = rgblight_get_mode();
	}
	prev = layer;
	return state;
}

